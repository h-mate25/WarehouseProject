@{
    ViewData["Title"] = "My Tasks";
    ViewData["Breadcrumb"] = "Home / My Tasks";
}

<div class="bg-gradient-to-r from-[#4169e1] to-[#60dcb3] text-white p-4 mb-8 rounded-lg shadow-lg">
    <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
            <i class="ri-information-line text-2xl"></i>
            <div>
                <h3 class="font-semibold">Development Notice</h3>
                <p class="text-sm opacity-90">This page is under development and contains non-real data for demonstration purposes.</p>
            </div>
        </div>
        <button class="text-white hover:text-gray-200 transition-colors" onclick="this.parentElement.parentElement.remove()">
            <i class="ri-close-line text-xl"></i>
        </button>
    </div>
</div>

<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div class="bg-white p-6 rounded shadow-sm">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-500">Tasks Today</p>
                <h3 class="text-2xl font-bold mt-2">8</h3>
            </div>
            <div class="w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center">
                <i class="ri-task-line text-blue-500"></i>
            </div>
        </div>
        <div class="mt-4 text-sm text-blue-500">
            <span>3 completed</span>
        </div>
    </div>
    <div class="bg-white p-6 rounded shadow-sm">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-500">Pending Shipments</p>
                <h3 class="text-2xl font-bold mt-2">5</h3>
            </div>
            <div class="w-12 h-12 bg-orange-50 rounded-full flex items-center justify-center">
                <i class="ri-truck-line text-orange-500"></i>
            </div>
        </div>
        <div class="mt-4 text-sm text-orange-500">
            <span>2 high priority</span>
        </div>
    </div>
    <div class="bg-white p-6 rounded shadow-sm">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-500">Items Processed</p>
                <h3 class="text-2xl font-bold mt-2">124</h3>
            </div>
            <div class="w-12 h-12 bg-green-50 rounded-full flex items-center justify-center">
                <i class="ri-box-3-line text-green-500"></i>
            </div>
        </div>
        <div class="mt-4 text-sm text-green-500">
            <span>Today's count</span>
        </div>
    </div>
    <div class="bg-white p-6 rounded shadow-sm">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-500">Performance</p>
                <h3 class="text-2xl font-bold mt-2">96%</h3>
            </div>
            <div class="w-12 h-12 bg-purple-50 rounded-full flex items-center justify-center">
                <i class="ri-line-chart-line text-purple-500"></i>
            </div>
        </div>
        <div class="mt-4 text-sm text-purple-500">
            <span>Above target</span>
        </div>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
    <div class="lg:col-span-2 bg-white rounded shadow-sm">
        <div class="p-6 border-b flex justify-between items-center">
            <h3 class="text-lg font-bold">Today's Tasks</h3>
            <div class="flex gap-2">
                <button class="task-filter-btn px-4 py-2 bg-secondary text-primary rounded-full text-sm font-medium" data-filter="all">All Tasks</button>
                <button class="task-filter-btn px-4 py-2 hover:bg-gray-100 text-gray-600 rounded-full text-sm font-medium" data-filter="pending">Pending</button>
                <button class="task-filter-btn px-4 py-2 hover:bg-gray-100 text-gray-600 rounded-full text-sm font-medium" data-filter="completed">Completed</button>
            </div>
        </div>
        <div class="p-6 space-y-4 tasks-container">
            <div class="task-item flex items-center gap-4 p-4 bg-secondary rounded-lg" data-status="pending">
                <input type="checkbox" class="task-checkbox w-5 h-5 rounded text-primary" data-task-id="task1">
                <div class="flex-1">
                    <h4 class="task-title font-medium">Process inbound shipment #IN202503121001</h4>
                    <p class="text-sm text-gray-500 mt-1">Apple Inc. - 200 iPhone 15 Pro Max units</p>
                </div>
                <span class="px-3 py-1 bg-red-50 text-red-600 rounded-full text-sm">High Priority</span>
                <button class="p-2 hover:bg-gray-200 rounded-full">
                    <i class="ri-more-2-fill"></i>
                </button>
            </div>
            <div class="task-item flex items-center gap-4 p-4 bg-secondary rounded-lg" data-status="pending">
                <input type="checkbox" class="task-checkbox w-5 h-5 rounded text-primary" data-task-id="task2">
                <div class="flex-1">
                    <h4 class="task-title font-medium">Update inventory count for Zone B</h4>
                    <p class="text-sm text-gray-500 mt-1">Monthly inventory audit</p>
                </div>
                <span class="px-3 py-1 bg-yellow-50 text-yellow-600 rounded-full text-sm">Medium Priority</span>
                <button class="p-2 hover:bg-gray-200 rounded-full">
                    <i class="ri-more-2-fill"></i>
                </button>
            </div>
            <div class="task-item flex items-center gap-4 p-4 bg-secondary rounded-lg" data-status="completed">
                <input type="checkbox" class="task-checkbox w-5 h-5 rounded text-primary" data-task-id="task3" checked>
                <div class="flex-1">
                    <h4 class="task-title font-medium line-through text-gray-400">Prepare outbound shipment #OUT202503121003</h4>
                    <p class="text-sm text-gray-500 mt-1">Best Buy - 50 MacBook Pro units</p>
                </div>
                <span class="px-3 py-1 bg-green-50 text-green-600 rounded-full text-sm">Completed</span>
                <button class="p-2 hover:bg-gray-200 rounded-full">
                    <i class="ri-more-2-fill"></i>
                </button>
            </div>
        </div>
    </div>
    <div class="bg-white rounded shadow-sm">
        <div class="p-6 border-b">
            <h3 class="text-lg font-bold">Quick Actions</h3>
        </div>
        <div class="p-6 space-y-4">
            <button onclick="showModal('scanModal')" class="quick-action-btn w-full flex items-center justify-between p-4 bg-blue-50 text-blue-600 rounded-button hover:bg-blue-100" data-action="scan">
                <span>Scan New Item</span>
                <i class="ri-qr-scan-line"></i>
            </button>
            <button onclick="showModal('shipmentModal')" class="quick-action-btn w-full flex items-center justify-between p-4 bg-green-50 text-green-600 rounded-button hover:bg-green-100" data-action="shipment">
                <span>Start Shipment</span>
                <i class="ri-truck-line"></i>
            </button>
            <button onclick="showModal('issueModal')" class="quick-action-btn w-full flex items-center justify-between p-4 bg-purple-50 text-purple-600 rounded-button hover:bg-purple-100" data-action="issue">
                <span>Report Issue</span>
                <i class="ri-error-warning-line"></i>
            </button>
            <button onclick="showModal('supportModal')" class="quick-action-btn w-full flex items-center justify-between p-4 bg-orange-50 text-orange-600 rounded-button hover:bg-orange-100" data-action="support">
                <span>Request Support</span>
                <i class="ri-customer-service-line"></i>
            </button>
        </div>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <div class="bg-white rounded shadow-sm">
        <div class="p-6 border-b">
            <h3 class="text-lg font-bold">Weekly Performance</h3>
        </div>
        <div id="performanceChart" class="chart-container"></div>
    </div>
    <div class="bg-white rounded shadow-sm">
        <div class="flex items-center justify-between px-4 py-3 border-b">
            <h3 class="text-lg font-semibold text-gray-900">Recent Activity</h3>
            <button data-modal="allActivitiesModal" class="text-sm text-blue-600 hover:underline">View All</button>
        </div>
        <div class="max-h-[400px] overflow-y-auto">
            <div id="recentActivities" class="p-6 space-y-6">
                <p class="text-gray-500">Loading recent activities...</p>
            </div>
        </div>
    </div>
</div>

<!-- Modal: All System Activities -->
<div class="modal" id="allActivitiesModal">
    <div class="bg-white w-full max-w-4xl m-auto rounded-lg p-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-bold">All System Activities</h3>
            <button data-close-modal="allActivitiesModal" class="text-gray-400 hover:text-gray-600">
                <i class="ri-close-line text-xl"></i>
            </button>
        </div>
        <div class="flex justify-between items-center mb-4">
            <div class="flex gap-2">
                <select id="activityTypeFilter" class="p-2 border rounded-button text-sm">
                    <option value="">All Types</option>
                    <option value="Add">Add</option>
                    <option value="Remove">Remove</option>
                    <option value="Update">Update</option>
                    <option value="Complete">Complete</option>
                </select>
                <input type="text" id="activitySearchInput" placeholder="Search activities..." class="p-2 border rounded-button text-sm">
            </div>
            <button id="activityRefreshBtn" class="text-gray-600 hover:text-gray-900">
                <i class="ri-refresh-line mr-1"></i> Refresh
            </button>
        </div>
        <div class="overflow-auto max-h-[60vh]">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50 sticky top-0">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Item</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                    </tr>
                </thead>
                <tbody id="allActivitiesTableBody" class="bg-white divide-y divide-gray-200">
                    <tr>
                        <td colspan="5" class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">
                            Loading activities...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="mt-4 flex justify-center">
            <button id="loadMoreActivitiesBtn" class="px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200">
                Load More
            </button>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/tasks.js"></script>
    <script>
        // Initialize performance chart
        document.addEventListener('DOMContentLoaded', function() {
            const performanceChart = echarts.init(document.getElementById('performanceChart'));
            const performanceOption = {
                animation: false,
                title: {
                    text: 'Tasks Completed',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'axis'
                },
                xAxis: {
                    type: 'category',
                    data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
                },
                yAxis: {
                    type: 'value'
                },
                series: [{
                    data: [15, 12, 18, 14, 16, 10, 8],
                    type: 'line',
                    smooth: true,
                    color: 'rgba(87, 181, 231, 1)',
                    areaStyle: {
                        color: {
                            type: 'linear',
                            x: 0,
                            y: 0,
                            x2: 0,
                            y2: 1,
                            colorStops: [{
                                offset: 0,
                                color: 'rgba(87, 181, 231, 0.3)'
                            }, {
                                offset: 1,
                                color: 'rgba(87, 181, 231, 0.1)'
                            }]
                        }
                    }
                }]
            };
            performanceChart.setOption(performanceOption);
            
            // Handle window resize
            window.addEventListener('resize', function() {
                performanceChart.resize();
            });
            
            console.log('Tasks view initialized');
        });
    </script>
} 